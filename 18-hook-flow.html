<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Hook Flow</title>
</head>
<body>
    <div id="root"></div>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script type="text/babel">
        // Check out the hook flow diagram here -  https://github.com/donavon/hook-flow

        function Child(){ 
            console.log("%c   Child: render start", "color:green");

            // useState lazy initialization function is invoked only once while the component is mounted(i.e during the rendering of the component).
            // It is not invoked again in its lifetime.
            // When the component is unmounted and mounted again, it is invoked only once with new instance.
            const [count, setCount] = React.useState(
                () => {
                    console.log("%c   Child: useState callback", "color:Magenta");
                    return 0
                }
            );

            React.useEffect(
                () => {
                    // useEffect no deps is invoked first time after the component is mounted(renders the component)
                    // useEffect no deps is also invoked on every update after - 1.React renders the DOM element of the component and 2.cleanup
                    console.log("%c   Child: useEffect no deps", "color:red")
                    return ()=> {
                        // useEffect no deps cleanup is invoked on every update after rendering the component.
                        console.log("%c   Child: useEffect no deps cleanup", "color:orange");
                    }
                }
            );

            React.useEffect(
                () => {
                    // useEffect empty deps is invoked only once after the component is mounted
                    console.log("%c   Child: useEffect empty deps", "color:red")
                    return () =>{
                        // useEffect empty deps cleanup is invoked only once when the component is unmounted
                        console.log("%c   Child: useEffect empty deps cleanup","color:orange")
                    }
                },
                []
            );

            React.useEffect(
                () => {
                    // useEffect with deps is invoked first time after the component is mounted(renders the component)
                    // useEffect with deps is also invoked on every update after - 1.React renders the DOM element of the component and 2.cleanup
                    console.log("%c   Child: useEffect with deps", "color:red")
                    return () => {
                        //  useEffect with deps cleanup is invoked in every update after rendering the component
                        console.log("%c   Child: useEffect with deps cleanup", "color:orange")
                    }
                },
                [count]
            );

            const element = (
                <button 
                onClick={() => setCount(count => count+1)}
                style = {{
                    width:70,
                    height:30,
                    backgroundColor:'yellow',
                    borderRadius: 50,
                    fontSize: 'large',
                }}
                >
                <b>{count}</b>    
                </button>
            )

            console.log("%c   Child: render end", "color:green");

            return element;
        }

        function App(){
            console.log("%cApp: render start", "color:green")

            // useState lazy initialization function is invoked only once while the component is mounted(i.e during the rendering of the component).
            // It is not invoked again in its lifetime.
            // When the component is unmounted and mounted again, it is invoked only once with new instance.
            const [showChild, setShowChild] = React.useState(
                () => {
                    console.log("%cApp: useState callback", "color:Magenta");
                    return false;
                }
            );

            React.useEffect(
                () => {
                    // useEffect no deps is invoked first time after the component is mounted(renders the component)
                    // useEffect no deps is also invoked on every update after - 1.React renders the DOM element of the component and 2.cleanup
                    console.log("%cApp: useEffect no deps", "color:red")
                    return () => {
                        // useEffect no deps cleanup is invoked on every update after rendering the component.
                        console.log("%cApp: useEffect no deps cleanup", "color:orange")
                    }
                }
            );

            React.useEffect(
                () => {
                    // useEffect empty deps is invoked only once after the component is mounted
                    console.log("%cApp: useEffect empty deps", "color:red")
                    return () =>{
                        //  useEffect empty deps cleanup is invoked only once when the component is unmounted
                        console.log("%cApp: useEffect empty deps cleanup", "color:orange")
                    }
                },
                []
            );

            React.useEffect(
                () => {
                     // useEffect with deps is invoked first time after the component is mounted(renders the component)
                    // useEffect with deps is also invoked on every update after - 1.React renders the DOM element of the component and 2.cleanup
                    console.log("%cApp: useEffect with deps", "color:red")
                    return () => {
                        //  useEffect with deps cleanup is invoked in every update after rendering the component
                        console.log("%cApp: useEffect with deps cleanup", "color:orange")
                    }
                },
                [showChild]
            )

            const element = (
                <>
                <label>
                    <input 
                    type="checkbox" 
                    checked = {showChild}
                    onChange = {e => setShowChild(e.target.checked)}
                    />
                    {' '}
                Show Child
                </label>
                <div
                    style ={{
                        border : '2px solid black',
                        height : 100,
                        width : 100,
                        margin : 10,
                        padding : 10,
                        backgroundColor : 'coral',
                        display : 'flex',
                        justifyContent: 'center',
                        alignItems: 'center'
                    }}
                >
                    {showChild ? <Child /> : null}
                </div>
                </>
            );

            console.log("%cApp: render end", "color: green");

            return element;
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>